/**
 * spawn.js
 * Created by raul on 11/19/14.
 */

var RSVP = require('rsvp');
var child_process = require('child_process');

module.exports = function exec(command, args, cwd) {
    return new RSVP.Promise(function(resolve, reject) {

        var proc = child_process.spawn(command, args, cwd);

        // proc.stdout.on('data', function (data) {
        //   console.log(data);
        // });

        // proc.stderr.on('data', function (data) {
        //   console.log(data);
        // });


        proc.on('close', function(code) {
            if (code !== 0) {
                reject(new Error(command + " " + args.join(" ") + " in " + cwd + " exited with code " + code));
            } else {
                resolve(code);
            }
        });
    });
}